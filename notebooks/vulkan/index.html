<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<title>Notebook: Vulkan &mdash; remexre.xyz</title>
		<link rel="stylesheet" type="text/css" href="https:&#x2F;&#x2F;remexre.xyz&#x2F;css/main.css">
		<style>article { width: calc(100% - 1.0rem); }</style>
	</head>
	<body>
		<header>
			<a class="subtle" href="https:&#x2F;&#x2F;remexre.xyz&#x2F;">Home</a>
			<a class="subtle" href="https:&#x2F;&#x2F;remexre.xyz&#x2F;tags">Tags</a>
			<a class="subtle" href="https:&#x2F;&#x2F;remexre.xyz&#x2F;contact">Contact</a>
			<a class="subtle" href="https:&#x2F;&#x2F;remexre.xyz&#x2F;projects">Projects</a>
		</header>
		<div class="spacer"></div>
		
<article>
	<h1 class="title">
		<a class="subtle" href="https:&#x2F;&#x2F;remexre.xyz&#x2F;notebooks&#x2F;vulkan&#x2F;">Notebook: Vulkan</a>
		<span class="spacer"></span>
		<span class="meta">
			</span>
	</h1>
	<h1 id="nova">nova</h1>
<p>goal:</p>
<ul>
<li>type-safe</li>
<li>sync-safe</li>
<li>raii</li>
</ul>
<p>biggest new abstraction: monad for commands on a command buffer</p>
<ul>
<li>have an operator <code>merge : (M a, M b) -&gt; M (a, b)</code> that makes commands ordering-independent</li>
<li>probably helpers <code>mergeAll : [M a] -&gt; M [a]</code>, <code>mergeAll_ : [M ()] -&gt; M ()</code></li>
<li>in theory, nothing but <code>&gt;&gt;=</code> should require synchronization</li>
<li>consequently, discourage <code>&gt;&gt;=</code> -- maybe don't even define a <code>Monad</code> instance?</li>
<li>this would also allow a custom <code>&gt;&gt;</code> operator for subpasses</li>
<li>maybe want an explicit operator for secondary command buffers?</li>
</ul>
<p>issue for command monad: resource synchronization</p>
<ul>
<li>rust-style (or use rust) <code>&amp;mut</code>?</li>
<li>would need to give the resource back... after the <code>&gt;&gt;=</code></li>
<li>might make sense to make ops often be <code>a -o M a</code> instead of <code>a -&gt; M ()</code></li>
<li>this would allow typestates too: <code>T S1 -o M (T S2)</code></li>
</ul>
<h3 id="api">API</h3>
<p><code>Device : *</code></p>
<p>Device also contains instance.</p>
<ul>
<li><code>make_device : Target t =&gt; t -o Device</code></li>
</ul>
<p><code>Cmd : * -&gt; *</code></p>
<ul>
<li><code>pure : a -o Cmd a</code></li>
<li><code>and_then : (a -o Cmd b) -&gt; Cmd a -o Cmd b</code></li>
<li><code>par : Cmd a -o Cmd b -o Cmd (a, b)</code></li>
<li><code>par_ : Cmd () -o Cmd () -o Cmd ()</code></li>
<li><code>run : Device -&gt; Cmd a -o a</code></li>
</ul>
<p><code>CmdBufUsage : *</code></p>
<ul>
<li><code>OneTimeSubmit : CmdBufUsage</code></li>
<li><code>Reusable : CmdBufUsage</code></li>
</ul>
<p><code>CmdBufTypeState : *</code></p>
<ul>
<li><code>Initial : CmdBufTypeState</code></li>
<li><code>Recording : CmdBufUsage -&gt; CmdBufTypeState</code></li>
<li><code>Executable : CmdBufUsage -&gt;CmdBufTypeState</code></li>
<li><code>Pending : CmdBufUsage -&gt; CmdBufTypeState</code></li>
<li><code>Invalid : CmdBufTypeState</code></li>
</ul>
<p><code>Invalidatable : CmdBufTypeState -&gt; Constraint</code></p>
<ul>
<li><code>Invalidatable Initial</code></li>
<li><code>Invalidatable Recording</code></li>
<li><code>Invalidatable Executable</code></li>
</ul>
<p><code>Resettable : CmdBufTypeState -&gt; Constraint</code></p>
<ul>
<li><code>Resettable Recording</code></li>
<li><code>Resettable Executable</code></li>
<li><code>Resettable Invalid</code></li>
</ul>
<p><code>CmdBuf : CmdBufTypeState -&gt; *</code></p>
<ul>
<li><code>allocate : Device -&gt; CmdBuf Initial</code></li>
<li><code>destroy : Resettable t =&gt; CmdBuf t -o Unit</code></li>
<li><code>begin : (t : CmdBufUsage) -&gt; CmdBuf Initial -o CmdBuf (Recording t)</code></li>
<li><code>end : CmdBuf (Recording t) -o CmdBuf (Executable t)</code></li>
<li><code>submit : CmdBuf (Executable t) -o CmdBuf (Pending t)</code></li>
<li><code>waitComplete : CmdBuf (Pending Reusable) -o CmdBuf (Executable Reusable)</code></li>
<li><code>waitCompleteOne : CmdBuf (Pending OneTimeSubmit) -o CmdBuf Invalid</code></li>
<li><code>invalidate : Invalidatable t =&gt; CmdBuf t -o CmdBuf Invalid</code></li>
<li><code>reset : Resettable t =&gt; CmdBuf t -o CmdBuf Initial</code></li>
</ul>
<p><code>Image : *</code></p>
<ul>
<li><code>create : Device -&gt; Image</code></li>
<li><code>destroy : Image -o ()</code></li>
</ul>

</article>
<div class="comments">
		Comments are not enabled on this post.
	</div>

		<div class="spacer"></div>
		
<script src="https:&#x2F;&#x2F;remexre.xyz&#x2F;ext/anchor.min.js"></script>
<script>
	const anchors = new AnchorJS();
	anchors.options.class = "icon subtle";
	anchors.options.placement = "left";
	anchors.add("article h1:not(.title), article h2");
</script>

	</body>
</html>
